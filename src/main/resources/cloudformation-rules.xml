<cloudformation-rules>
	<rule>
		<key>F1</key>
		<name>EBS volumes should be encrypted</name>
		<internalKey>F1</internalKey>
		<description>EBS volume should have server-side encryption enabled</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-311</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F2</key>
		<name>IAM role should not allow * action on its trust policy</name>
		<internalKey>F2</internalKey>
		<description>IAM role should not allow * action on its trust policy</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F3</key>
		<name>IAM role should not allow * action on its permissions policy</name>
		<internalKey>F3</internalKey>
		<description>IAM role should not allow * action on its permissions policy</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F4</key>
		<name>IAM policy should not allow * action</name>
		<internalKey>F4</internalKey>
		<description>IAM policy should not allow * action</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F5</key>
		<name>IAM managed policy should not allow * action</name>
		<internalKey>F5</internalKey>
		<description>IAM managed policy should not allow * action</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F6</key>
		<name>IAM role should not allow Allow+NotPrincipal in its trust policy</name>
		<internalKey>F6</internalKey>
		<description>IAM role should not allow Allow+NotPrincipal in its trust policy</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F7</key>
		<name>SQS Queue policy should not allow Allow+NotPrincipal</name>
		<internalKey>F7</internalKey>
		<description>SQS Queue policy should not allow Allow+NotPrincipal</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F8</key>
		<name>SNS Topic policy should not allow Allow+NotPrincipal</name>
		<internalKey>F8</internalKey>
		<description>SNS Topic policy should not allow Allow+NotPrincipal</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>     
	<rule>
		<key>F9</key>
		<name>S3 Bucket policy should not allow Allow+NotPrincipal</name>
		<internalKey>F9</internalKey>
		<description>S3 Bucket policy should not allow Allow+NotPrincipal</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F10</key>
		<name>IAM user should not have any inline policies.  Should be centralized Policy object on group</name>
		<internalKey>F10</internalKey>
		<description>IAM user should not have any inline policies. Should be centralized Policy object on group</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F11</key>
		<name>IAM policy should not apply directly to users.  Should be on group</name>
		<internalKey>F11</internalKey>
		<description>IAM policy should not apply directly to users.  Should be on group</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F12</key>
		<name>IAM managed policy should not apply directly to users.  Should be on group</name>
		<internalKey>F12</internalKey>
		<description>IAM managed policy should not apply directly to users.  Should be on group</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F13</key>
		<name>Lambda permission principal should not be wildcard</name>
		<internalKey>F13</internalKey>
		<description>Lambda permission principal should not be wildcard</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F14</key>
		<name>S3 Bucket should not have a public read-write acl</name>
		<internalKey>F14</internalKey>
		<description>S3 Bucket should not have a public read-write acl</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F15</key>
		<name>S3 Bucket policy should not allow * action</name>
		<internalKey>F15</internalKey>
		<description>S3 Bucket policy should not allow * action</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F16</key>
		<name>S3 Bucket policy should not allow * principal</name>
		<internalKey>F16</internalKey>
		<description>S3 Bucket policy should not allow * principal</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F18</key>
		<name>SNS topic policy should not allow * principal</name>
		<internalKey>F18</internalKey>
		<description>SNS topic policy should not allow * principal</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F20</key>
		<name>SQS Queue policy should not allow * action</name>
		<internalKey>F2+</internalKey>
		<description>SQS Queue policy should not allow * action</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F21</key>
		<name>SQS Queue policy should not allow * principal</name>
		<internalKey>F21</internalKey>
		<description>SQS Queue policy should not allow * principal</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>
	<rule>
		<key>F22</key>
		<name>RDS instance should not be publicly accessible</name>
		<internalKey>F22</internalKey>
		<description>RDS instance should not be publicly accessible</description>
		<severity>Blocker</severity>
		<cardinality>SINGLE</cardinality>
		<status>READY</status>
		<type>VULNERABILITY</type>
		<tag>owasp-a6</tag>
		<tag>cweid-732</tag>		
		<remediationFunction>CONSTANT_ISSUE</remediationFunction>
        <remediationFunctionBaseEffort>10min</remediationFunctionBaseEffort>
     </rule>


     <!-- 
Failing violations

F23 RDS instance master user password must be Ref to NoEcho Parameter. Default credentials are not recommended
F24 ElastiCache ReplicationGroup should have encryption enabled for in transit
F25 ElastiCache ReplicationGroup should have encryption enabled for at rest
F26 RDS DBCluster should have StorageEncrypted enabled
F27 EFS FileSystem should have encryption enabled
F28 Redshift Cluster should have encryption enabled
F29 Workspace should have encryption enabled
F30 Neptune database cluster storage should have encryption enabled
F31 DirectoryService::SimpleAD should use a parameter for password, with NoEcho
F665 WebAcl DefaultAction should not be ALLOW
F1000 Missing egress rule means all traffic is allowed outbound.  Make this explicit if it is desired configuration
F2000 User is not assigned to a group


     
WARNING VIOLATIONS:
W1 Specifying credentials in the template itself is probably not the safest thing
W2 Security Groups found with cidr open to world on ingress.  This should never be true on instance.  Permissible on ELB
W5 Security Groups found with cidr open to world on egress
W9 Security Groups found with ingress cidr that is not /32
W10 CloudFront Distribution should enable access logging
W11 IAM role should not allow * resource on its permissions policy
W12 IAM policy should not allow * resource
W13 IAM managed policy should not allow * resource
W14 IAM role should not allow Allow+NotAction on trust permissions
W15 IAM role should not allow Allow+NotAction
W16 IAM policy should not allow Allow+NotAction
W17 IAM managed policy should not allow Allow+NotAction
W18 SQS Queue policy should not allow Allow+NotAction
W19 SNS Topic policy should not allow Allow+NotAction
W20 S3 Bucket policy should not allow Allow+NotAction
W21 IAM role should not allow Allow+NotResource
W22 IAM policy should not allow Allow+NotResource
W23 IAM managed policy should not allow Allow+NotResource
W24 Lambda permission beside InvokeFunction might not be what you want? Not sure!?
W26 Elastic Load Balancer should have access logging enabled
W27 Security Groups found ingress with port range instead of just a single port
W28 Resource found with an explicit name, this disallows updates that require replacement of this resource
W29 Security Groups found egress with port range instead of just a single port
W31 S3 Bucket likely should not have a public read acl
W32 CodeBuild project should specify an EncryptionKey value
W33 EC2 Subnet should not have MapPublicIpOnLaunch set to true
W34 Batch Job Definition Container Properties should not have Privileged set to true          
      -->
     
</cloudformation-rules>